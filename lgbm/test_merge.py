from scipy.sparse import save_npz, load_npz, csr_matrix, hstack
import numpy as np

train_embedding = np.load('../xdeepfm_train_embedding.npy')
test_embedding = np.load('../xdeepfm_test_embedding.npy')
print(train_embedding.shape)
print(test_embedding.shape)

train = load_npz('train.npz')
test = load_npz('test.npz')
print(train.shape)
print(test.shape)

train_embedding = train_embedding.reshape((train_embedding.shape[0], -1))
test_embedding = train_embedding.reshape((train_embedding.shape[0], -1))
print(train_embedding.shape)
print(test_embedding.shape)

import code
code.interact(local=locals())

train = hstack([train, train_embedding])

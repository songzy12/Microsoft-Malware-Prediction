import numpy as np
import pandas as pd
import os

from scipy.stats import rankdata

LABELS = ["HasDetections"]

predict_list = []

submissions = ['lgbm/lgb_submission.csv',
               'nffm/xdeepfm_submission.csv']

for submission in submissions:
    predict_list.append(pd.read_csv(submission)[LABELS].values)

print("Rank averaging on ", len(predict_list), " files")
predictions = np.zeros_like(predict_list[0])
for predict in predict_list:
    for i in range(1):
        predictions[:, i] = np.add(predictions[:, i], rankdata(
            predict[:, i])/predictions.shape[0])
predictions /= len(predict_list)

submission = pd.read_csv('input/sample_submission.csv')
submission[LABELS] = predictions
submission.to_csv('blend_submission.csv', index=False)
